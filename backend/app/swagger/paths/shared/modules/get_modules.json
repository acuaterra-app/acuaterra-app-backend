{
  "/api/v2/shared/modules/{farm_id}": {
    "get": {
      "tags": ["Shared/Modules"],
      "summary": "Get all modules for a specific farm",
      "description": "Retrieves a paginated list of all modules (both active and inactive) for the specified farm with detailed information including creator and farm data. Both active and inactive users and farms are included in the relationships. This endpoint implements role-based access control through the validateUserAccessMiddleware. When accessed by an OWNER, all modules in the farm are returned. When accessed by a MONITOR, the middleware first verifies the monitor has access to the specified farm, then filters the modules to only include those the monitor has been assigned to. This updated version displays all modules regardless of their activation status to support module activation/deactivation functionality.",
      "parameters": [
        {
          "in": "path",
          "name": "farm_id",
          "required": true,
          "schema": {
            "type": "integer"
          },
          "description": "ID of the farm to retrieve modules from"
        },
        {
          "in": "query",
          "name": "page",
          "schema": {
            "type": "integer",
            "default": 1
          },
          "description": "Page number for pagination"
        },
        {
          "in": "query",
          "name": "limit",
          "schema": {
            "type": "integer",
            "default": 10
          },
          "description": "Number of items per page"
        },
        {
          "in": "query",
          "name": "sortField",
          "schema": {
            "type": "string",
            "default": "createdAt"
          },
          "description": "Field to sort the results by"
        },
        {
          "in": "query",
          "name": "sortOrder",
          "schema": {
            "type": "string",
            "default": "DESC",
            "enum": ["ASC", "DESC"]
          },
          "description": "Sort order (ASC for ascending, DESC for descending)"
        }
      ],
      "security": [
        {
          "BearerAuth": []
        }
      ],
      "responses": {
        "200": {
          "description": "Successful operation - modules retrieved",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "message": {
                    "type": "string",
                    "example": "All modules retrieved successfully"
                  },
                  "data": {
                    "type": "array",
                    "description": "Array of modules (both active and inactive)",
                    "items": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "integer",
                          "example": 2
                        },
                        "name": {
                          "type": "string",
                          "example": "Module stunning"
                        },
                        "location": {
                          "type": "string",
                          "example": "5914 Southwest Wing"
                        },
                        "latitude": {
                          "type": "string",
                          "example": "-87.8914"
                        },
                        "longitude": {
                          "type": "string",
                          "example": "29.9271"
                        },
                        "species_fish": {
                          "type": "string",
                          "example": "Trout"
                        },
                        "fish_quantity": {
                          "type": "string",
                          "example": "300"
                        },
                        "fish_age": {
                          "type": "string",
                          "example": "9"
                        },
                        "dimensions": {
                          "type": "string",
                          "example": "4x2x1"
                        },
                        "id_farm": {
                          "type": "integer",
                          "example": 2
                        },
                        "created_by_user_id": {
                          "type": "integer",
                          "example": 1
                        },
                        "createdAt": {
                          "type": "string",
                          "format": "date-time",
                          "example": "2025-03-04T21:55:42.000Z"
                        },
                        "updatedAt": {
                          "type": "string",
                          "format": "date-time",
                          "example": "2025-03-04T21:55:42.000Z"
                        },
                        "isActive": {
                          "type": "boolean",
                          "example": true,
                          "description": "Indicates whether the module is active in the system"
                        },
                        "creator": {
                          "type": "object",
                          "properties": {
                            "id": {
                              "type": "integer",
                              "example": 1
                            },
                            "name": {
                              "type": "string",
                              "example": "Jerry Lind"
                            },
                            "email": {
                              "type": "string",
                              "example": "admin@example.com"
                            },
                            "dni": {
                              "type": "string",
                              "example": "6167217327"
                            },
                            "id_rol": {
                              "type": "integer",
                              "example": 1
                            },
                            "isActive": {
                              "type": "boolean",
                              "example": true,
                              "description": "Indicates whether the user is active in the system"
                            },
                            "rol": {
                              "type": "object",
                              "properties": {
                                "id": {
                                  "type": "integer",
                                  "example": 1
                                },
                                "name": {
                                  "type": "string",
                                  "example": "Administrator"
                                }
                              }
                            }
                          }
                        },
                        "farm": {
                          "type": "object",
                          "properties": {
                            "id": {
                              "type": "integer",
                              "example": 2
                            },
                            "name": {
                              "type": "string",
                              "example": "West Hartford"
                            },
                            "address": {
                              "type": "string",
                              "example": "969 Schneider Pike"
                            },
                            "latitude": {
                              "type": "string",
                              "example": "52.1592"
                            },
                            "longitude": {
                              "type": "string",
                              "example": "146.6592"
                            },
                            "isActive": {
                              "type": "boolean",
                              "example": true,
                              "description": "Indicates whether the farm is active in the system"
                            }
                          }
                        }
                      }
                    },
                    "example": [
                      {
                        "id": 2,
                        "name": "Module stunning",
                        "location": "5914 Southwest Wing",
                        "latitude": "-87.8914",
                        "longitude": "29.9271",
                        "species_fish": "Trout",
                        "fish_quantity": "300",
                        "fish_age": "9",
                        "dimensions": "4x2x1", 
                        "id_farm": 2,
                        "created_by_user_id": 1,
                        "isActive": true,
                        "createdAt": "2025-03-04T21:55:42.000Z",
                        "updatedAt": "2025-03-04T21:55:42.000Z",
                        "creator": {
                          "id": 1,
                          "name": "Jerry Lind",
                          "email": "admin@example.com",
                          "dni": "6167217327",
                          "id_rol": 1,
                          "rol": {
                            "id": 1,
                            "name": "Administrator"
                          }
                        },
                        "farm": {
                          "id": 2,
                          "name": "West Hartford", 
                          "address": "969 Schneider Pike",
                          "latitude": "52.1592",
                          "longitude": "146.6592",
                          "isActive": true
                        }
                      },
                      {
                        "id": 3,
                        "name": "Inactive Module Example",
                        "location": "North Sector",
                        "latitude": "-85.7123",
                        "longitude": "28.5432",
                        "species_fish": "Tilapia",
                        "fish_quantity": "200",
                        "fish_age": "5",
                        "dimensions": "3x2x1",
                        "id_farm": 2,
                        "created_by_user_id": 1,
                        "isActive": false,
                        "createdAt": "2025-03-05T10:15:22.000Z",
                        "updatedAt": "2025-05-02T14:32:45.000Z",
                        "creator": {
                          "id": 1,
                          "name": "Jerry Lind",
                          "email": "admin@example.com",
                          "dni": "6167217327",
                          "id_rol": 1,
                          "rol": {
                            "id": 1,
                            "name": "Administrator"
                          }
                        },
                        "farm": {
                          "id": 2,
                          "name": "West Hartford",
                          "address": "969 Schneider Pike",
                          "latitude": "52.1592",
                          "longitude": "146.6592",
                          "isActive": true
                        }
                      }
                    ]
                  },
                  "errors": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "example": []
                  },
                  "meta": {
                    "type": "object",
                    "properties": {
                      "pagination": {
                        "type": "object",
                        "properties": {
                          "total": {
                            "type": "integer",
                            "example": 5,
                            "description": "Total count of modules (both active and inactive)"
                          },
                          "totalPages": {
                            "type": "integer",
                            "example": 3,
                            "description": "Total number of pages based on limit parameter"
                          },
                          "currentPage": {
                            "type": "integer",
                            "example": 1,
                            "description": "Current page number"
                          },
                          "perPage": {
                            "type": "integer",
                            "example": 2,
                            "description": "Number of records per page"
                          },
                          "hasNext": {
                            "type": "boolean",
                            "example": true
                          },
                          "hasPrev": {
                            "type": "boolean",
                            "example": true
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "400": {
          "description": "Bad request",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "message": {
                    "type": "string",
                    "example": "Invalid request parameters"
                  },
                  "data": {
                    "type": "array",
                    "items": {},
                    "example": []
                  },
                  "errors": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "example": ["Page number must be a positive integer"]
                  },
                  "meta": {
                    "type": "object",
                    "example": {}
                  }
                }
              }
            }
          }
        },
        "401": {
          "description": "Unauthorized - Authentication credentials were missing or invalid",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "message": {
                    "type": "string",
                    "example": "Unauthorized access"
                  },
                  "data": {
                    "type": "array",
                    "items": {},
                    "example": []
                  },
                  "errors": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "example": ["Authentication required to access this resource"]
                  },
                  "meta": {
                    "type": "object",
                    "example": {}
                  }
                }
              }
            }
          }
        },
        "403": {
          "description": "Forbidden - User doesn't have permission to access this farm",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "message": {
                    "type": "string",
                    "example": "Access denied"
                  },
                  "data": {
                    "type": "array",
                    "items": {},
                    "example": []
                  },
                  "errors": {
                    "type": "array",
                    "items": {
                      "type": "object"
                    },
                    "example": [{"error": "Monitor does not have access to this farm"}]
                  },
                  "meta": {
                    "type": "object",
                    "example": {}
                  }
                }
              }
            }
          }
        },
        "500": {
          "description": "Server error",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "message": {
                    "type": "string",
                    "example": "Internal server error"
                  },
                  "data": {
                    "type": "array",
                    "items": {},
                    "example": []
                  },
                  "errors": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "example": ["Failed to retrieve modules"]
                  },
                  "meta": {
                    "type": "object",
                    "example": {}
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}

